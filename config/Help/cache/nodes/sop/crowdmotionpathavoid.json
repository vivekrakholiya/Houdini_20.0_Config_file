{"type": "root", "attrs": {"type": "node", "context": "sop", "internal": "crowdmotionpathavoid", "icon": "SOP/crowdmotionpathavoid", "tags": "crowds, agents", "since": "20.0", "version": null, "namespace": null}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Crowd MotionPath Avoid"], "extent": [126, 153]}, {"type": "summary", "indent": 0, "text": ["Deforms motion paths to avoid other agents and obstacles."], "extent": [153, 219]}, {"type": "para", "indent": 0, "text": ["This SOP applies an anticipatory avoidance model to deform motion paths to avoid future collisions with other agents or obstacles.\nThis can be useful for resolving collisions in an automated manner. For precise control over individual agents' paths, use ", {"scheme": "Node", "value": "/nodes/sop/crowdmotionpathfollow", "type": "link", "text": ["Crowd MotionPath Follow"], "fullpath": "/nodes/sop/crowdmotionpathfollow.html"}, " or ", {"scheme": "Node", "value": "/nodes/sop/crowdmotionpathedit", "type": "link", "text": ["Crowd MotionPath Edit"], "fullpath": "/nodes/sop/crowdmotionpathedit.html"}, "."], "extent": [219, 588]}, {"type": "para", "indent": 0, "text": ["The ", {"type": "code", "text": ["collisionignore"]}, " and ", {"type": "code", "text": ["collisiongroup"]}, " string attributes can be used to filter the avoidance behavior between paths.\nThese attributes can either be specified as point attributes on the agents (matching ", {"scheme": "Node", "value": "/nodes/dop/popsteeravoid", "type": "link", "text": ["POP Steer Avoid"], "fullpath": "/nodes/dop/popsteeravoid.html"}, ") or as primitive attributes on the motion paths.\nIf a path\u2019s ", {"type": "code", "text": ["collisionignore"]}, " string pattern matches the ", {"type": "code", "text": ["collisiongroup"]}, " of a neighboring path, the agent does not attempt to avoid the neighboring path.\nSince the ", {"type": "code", "text": ["collisionignore"]}, " attribute can have a different value for each path, the neighboring path could still be configured to avoid the agent."], "extent": [588, 1187]}, {"type": "para", "indent": 0, "text": ["See ", {"scheme": null, "value": "/crowds/sopcrowds", "type": "link", "text": ["SOP motion paths"], "fullpath": "/crowds/sopcrowds.html"}, " for more information on the SOP Crowds MotionPath toolset."], "extent": [1187, 1288]}, {"level": 1, "id": "parameters", "container": true, "type": "parameters_section", "indent": 0, "role": "section", "extent": [1288, 1300], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Group"], "extent": [1300, 1308], "body": [{"type": "para", "indent": 4, "text": ["The motion paths that are deformed to avoid other agents and obstacles."], "extent": [1323, 1400]}], "container": true, "attrs": {"id": "group"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Particle Scale Multiplier"], "extent": [1400, 1427], "body": [{"type": "para", "indent": 4, "text": ["The agent\u2019s ", {"type": "code", "text": ["pscale"]}, " point attribute is used as the agent\u2019s size for collision detection.\n    This parameter scales the value of ", {"type": "code", "text": ["pscale"]}, " in the calculation, allowing agents to be more or less tightly packed.\n    This parameter can be overridden by a ", {"type": "code", "text": ["pscalemultiplier"]}, " point attribute on the agent."], "extent": [1453, 1758]}], "container": true, "attrs": {"id": "pscalemultiplier"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Visualize Particle Scale"], "extent": [1758, 1784], "body": [{"type": "para", "indent": 4, "text": ["When turned on, guide geometry is displayed to visualize the collision radius of each agent."], "extent": [1809, 1907]}], "container": true, "attrs": {"id": "visualizepscale"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 3, "type": "sep", "indent": 0, "text": [" Avoidance "], "extent": [1907, 1925], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 4, "text": ["Avoidance"], "extent": [1925, 1941], "body": [{"type": "para", "indent": 8, "text": ["When turned on, avoidance is applied to the motion paths."], "extent": [1970, 2037]}, {"type": "tip_group", "body": [{"type": "tip", "indent": 8, "role": "item", "extent": [2037, 2050], "body": [{"type": "para", "indent": 12, "text": ["When ", {"type": "ui", "text": ["Avoidance"]}, " is turned off, collision detection (for example, generating the ", {"type": "ui", "text": ["Collision Point Group"]}, ") is still performed, so this can be used to detect existing collisions without deforming the paths."], "extent": [2050, 2272]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "attrs": {"id": "enableavoidance"}, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Iterations"], "extent": [2272, 2288], "body": [{"type": "para", "indent": 8, "text": ["The number of avoidance iterations to apply."], "extent": [2312, 2366]}, {"type": "tip_group", "body": [{"type": "tip", "indent": 8, "role": "item", "extent": [2366, 2379], "body": [{"type": "para", "indent": 12, "text": ["Applying additional avoidance iterations may resolve the remaining collisions from prior iterations.\n            However, later iterations may have little effect if, for example, the ", {"type": "ui", "text": ["Steering"]}, " parameters such as ", {"type": "ui", "text": ["Max Turn Rate"]}, " are too restrictive."], "extent": [2379, 2646]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "attrs": {"id": "iterations"}, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Max Collision Time"], "extent": [2646, 2670], "body": [{"type": "para", "indent": 8, "text": ["The maximum time to start avoiding potential collisions against neighbors or obstacles."], "extent": [2700, 2797]}], "container": true, "attrs": {"id": "maxcollisiontime"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 3, "type": "sep", "indent": 4, "text": [" Neighbors "], "extent": [2797, 2819], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 8, "text": ["Neighbors"], "extent": [2819, 2839], "body": [{"type": "para", "indent": 12, "text": ["When turned on, performs avoidance between neighboring agents."], "extent": [2872, 2948]}], "container": true, "attrs": {"id": "enableneighbors"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Neighbor Distance"], "extent": [2948, 2975], "body": [{"type": "para", "indent": 12, "text": ["The maximum distance an agent searches for nearby agents when anticipating collisions."], "extent": [3009, 3109]}], "container": true, "attrs": {"id": "neighbordistance"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Max Neighbors"], "extent": [3109, 3132], "body": [{"type": "para", "indent": 12, "text": ["The maximum number of nearby agents to consider when anticipating collisions."], "extent": [3162, 3253]}], "container": true, "attrs": {"id": "maxneighbors"}, "role": "item"}], "container": true, "role": "item_group"}], "container": true}, {"level": 3, "type": "sep", "indent": 4, "text": [" Obstacles "], "extent": [3253, 3275], "body": [{"type": "para", "indent": 8, "text": ["The parameters in this section are available when there is geometry connected to the Obstacles input."], "extent": [3275, 3387]}, {"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 8, "text": ["Obstacles"], "extent": [3387, 3406], "body": [{"type": "para", "indent": 12, "text": ["When turned on, performs avoidance between agents and geometry from the Obstacles input. "], "extent": [3439, 3542]}], "container": true, "attrs": {"id": "enableobstacles"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Obstacle Distance"], "extent": [3542, 3569], "body": [{"type": "para", "indent": 12, "text": ["The maximum distance an agent searches for obstacles when anticipating collisions."], "extent": [3603, 3699]}], "container": true, "attrs": {"id": "obstacledistance"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Collision Padding"], "extent": [3699, 3726], "body": [{"type": "para", "indent": 12, "text": ["An additional padding distance around the obstacle geometry.\n            This can be used to control how close agents can be to the obstacle."], "extent": [3759, 3914]}], "container": true, "attrs": {"id": "obstaclepadding"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Horizontal FOV"], "extent": [3914, 3938], "body": [{"type": "para", "indent": 12, "text": ["The agent\u2019s horizontal field of view (in degrees) when detecting obstacles."], "extent": [3969, 4058]}], "container": true, "attrs": {"id": "horizontalfov"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Vertical FOV"], "extent": [4058, 4080], "body": [{"type": "para", "indent": 12, "text": ["The agent\u2019s horizontal field of view (in degrees) when detecting obstacles."], "extent": [4109, 4198]}], "container": true, "attrs": {"id": "verticalfov"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Ray Samples"], "extent": [4198, 4219], "body": [{"type": "para", "indent": 12, "text": ["The number of raycasts to perform within the agent\u2019s field of view when detecting obstacles.\n            A higher number provides more accurate results at the cost of performance."], "extent": [4247, 4440]}], "container": true, "attrs": {"id": "fovsamples"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Samples Seed"], "extent": [4440, 4462], "body": [{"type": "para", "indent": 12, "text": ["When the ", {"type": "ui", "text": ["Horizontal FOV"]}, " and ", {"type": "ui", "text": ["Vertical FOV"]}, " are both non-zero, the ", {"type": "ui", "text": ["Ray Samples"]}, " are sent in randomly sampled directions within the FOV cone.\n            This controls the random seed for the sampling."], "extent": [4487, 4709]}], "container": true, "attrs": {"id": "fovseed"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Time Dependent"], "extent": [4709, 4733], "body": [{"type": "para", "indent": 12, "text": ["When turned on, the Obstacles input is cooked for each frame in the motion path\u2019s time range.\n            This allows the obstacle avoidance to be evaluated against time-dependent geometry."], "extent": [4766, 4969]}], "container": true, "attrs": {"id": "timedepobstacle"}, "role": "item"}], "container": true, "role": "item_group"}], "container": true}, {"level": 3, "type": "sep", "indent": 4, "text": [" Steering "], "extent": [4969, 4990], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 8, "text": ["Steering Mode"], "extent": [4990, 5014], "body": [{"type": "para", "indent": 12, "text": ["Specifies how the agent\u2019s orientation can change."], "extent": [5044, 5107]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 12, "text": ["2D"], "extent": [5107, 5123], "body": [{"type": "para", "indent": 16, "text": ["The agent can only be steered around its up vector. The up vector is determined by combining the ", {"type": "ui", "text": ["Reference Up"]}, " vector with the path\u2019s ", {"type": "code", "text": ["transform"]}, " attribute."], "extent": [5123, 5299]}], "container": true}, {"type": "dt", "indent": 12, "text": ["3D"], "extent": [5299, 5315], "body": [{"type": "para", "indent": 16, "text": ["The agent can be steered in any direction."], "extent": [5315, 5375]}], "container": true}], "container": true}], "container": true, "attrs": {"id": "steeringmode"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Speed Threshold"], "extent": [5375, 5400], "body": [{"type": "para", "indent": 12, "text": ["Specifies the minimum speed at which steering changes can be applied. This can prevent agents from spinning around while at a low speed."], "extent": [5436, 5586]}], "container": true, "attrs": {"id": "turnspeedthreshold"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Max Initial Rotation"], "extent": [5586, 5616], "body": [{"type": "para", "indent": 12, "text": ["When turned on, allows the motion path\u2019s initial point to be immediately rotated by up to this angle (in degrees) from its original direction, regardless of the ", {"type": "ui", "text": ["Max Turn Rate"]}, " and other steering limits.\n            This can be effective for avoiding collisions near the beginning of the motion path by changing the path\u2019s initial direction, rather than requiring the steering limits to be less restrictive (which affects the entire path\u2019s motion)."], "extent": [5652, 6116]}], "container": true, "attrs": {"id": "maxinitialrotation"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Max Turn Rate"], "extent": [6116, 6139], "body": [{"type": "para", "indent": 12, "text": ["Specifies how quickly the agent can change its orientation (in degrees per second) by rotating about its up axis."], "extent": [6168, 6295]}], "container": true, "attrs": {"id": "maxturnrate"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Turn Stiffness"], "extent": [6295, 6319], "body": [{"type": "para", "indent": 12, "text": ["When turned on, the agent\u2019s turning follows a damped angular spring, where its acceleration varies based on the angle from the target direction and the current turn rate. This prevents sharp changes to the agent\u2019s orientation or turn rate, while still allowing the agent to adjust quickly to large changes in its target direction. ", {"type": "ui", "text": ["Turn Stiffness"]}, " controls how quickly the agent accelerates based on the angle from its target direction, and ", {"type": "ui", "text": ["Max Turn Rate"]}, " provides an upper limit for the angular velocity. "], "extent": [6351, 6876]}], "container": true, "attrs": {"id": "turnstiffness"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Turn Damping"], "extent": [6876, 6898], "body": [{"type": "para", "indent": 12, "text": ["When ", {"type": "ui", "text": ["Turn Stiffness"]}, " is turned on, this is the damping for the angular spring. Larger values will avoid oscillation."], "extent": [6927, 7060]}], "container": true, "attrs": {"id": "turndamping"}, "role": "item"}, {"type": "parameters_item", "indent": 8, "text": ["Goal Position Weight"], "extent": [7060, 7090], "body": [{"type": "para", "indent": 12, "text": ["Controls the importance of steering the agent towards the original end position of its motion path.\n            If the value is 0, the motion path is entirely steered based on avoidance and does not have a target destination."], "extent": [7121, 7360]}], "container": true, "attrs": {"id": "goalposweight"}, "role": "item"}], "container": true, "role": "item_group"}], "container": true}], "container": true}, {"level": 3, "type": "sep", "indent": 0, "text": [" Collision Detection "], "extent": [7360, 7388], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 4, "text": ["Visualize Collisions"], "extent": [7388, 7415], "body": [{"type": "para", "indent": 8, "text": ["When turned on, highlights any points that are still colliding after applying avoidance."], "extent": [7448, 7546]}], "container": true, "attrs": {"id": "visualizecollisions"}, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Collision Point Group"], "extent": [7546, 7573], "body": [{"type": "para", "indent": 8, "text": ["When turned on, creates a point group containing any points on the motion paths in the ", {"type": "ui", "text": ["Group"]}, " that are still colliding after applying avoidance.\n        This can be used for visualization or for determining the paths that should be edited further to resolve the collisions."], "extent": [7603, 7889]}], "container": true, "attrs": {"id": "collisionptgroup"}, "role": "item"}], "container": true, "role": "item_group"}], "container": true}, {"level": 3, "type": "sep", "indent": 0, "text": [" Advanced "], "extent": [7889, 7906], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 4, "text": ["Substeps"], "extent": [7906, 7921], "body": [{"type": "para", "indent": 8, "text": ["The number of substeps to use for avoidance and collision detection.\n        Increasing the number of substeps may provide higher quality results, but incurs a performance cost."], "extent": [7943, 8130]}], "container": true, "attrs": {"id": "substeps"}, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Start Frame"], "extent": [8130, 8147], "body": [{"type": "para", "indent": 8, "text": ["The first frame at which avoidance is applied.\n        When turned on, applies avoidance to a specific time range of the motion paths."], "extent": [8171, 8315]}], "container": true, "attrs": {"id": "startframe"}, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["End Frame"], "extent": [8315, 8330], "body": [{"type": "para", "indent": 8, "text": ["The last frame at which avoidance is applied.\n        When turned on, applies avoidance to a specific time range of the motion paths."], "extent": [8352, 8495]}], "container": true, "attrs": {"id": "endframe"}, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Reference Up"], "extent": [8495, 8513], "body": [{"type": "para", "indent": 8, "text": ["The original up vector of the agent.\n        This is combined with the path\u2019s ", {"type": "code", "text": ["transform"]}, " attribute to determine the axis that the agent is steered around when the ", {"type": "ui", "text": ["Steering Mode"]}, " is ", {"type": "ui", "text": ["2D"]}, "."], "extent": [8532, 8734]}], "container": true, "attrs": {"id": "refup"}, "role": "item"}], "container": true, "role": "item_group"}], "container": true}], "text": "Parameters"}, {"level": 1, "id": "inputs", "container": true, "type": "inputs_section", "indent": 0, "role": "section", "extent": [8734, 8742], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 0, "text": ["Motion Paths"], "extent": [8742, 8757], "body": [{"type": "para", "indent": 4, "text": ["Polyline curves representing the paths of the agents over a time range."], "extent": [8757, 8834]}], "container": true}, {"type": "dt", "indent": 0, "text": ["Agents"], "extent": [8834, 8842], "body": [{"type": "para", "indent": 4, "text": ["A crowd of agents whose motion is represented by the Motion Paths."], "extent": [8842, 8914]}], "container": true}, {"type": "dt", "indent": 0, "text": ["Obstacles"], "extent": [8914, 8925], "body": [{"type": "para", "indent": 4, "text": ["Obstacle geometry that the motion paths should be deformed to avoid."], "extent": [8925, 8999]}], "container": true}], "container": true}], "text": "Inputs"}, {"level": 1, "id": "outputs", "container": true, "type": "outputs_section", "indent": 0, "role": "section", "extent": [8999, 9008], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 0, "text": ["Motion Paths"], "extent": [9008, 9023], "body": [{"type": "para", "indent": 4, "text": ["Polyline curves representing the paths of the agents over a time range."], "extent": [9023, 9100]}], "container": true}, {"type": "dt", "indent": 0, "text": ["Agents"], "extent": [9100, 9108], "body": [{"type": "para", "indent": 4, "text": ["A crowd of agents whose motion is represented by the Motion Paths."], "extent": [9108, 9180]}], "container": true}], "container": true}], "text": "Outputs"}, {"level": 1, "id": "related", "container": true, "type": "related_section", "indent": 0, "role": "section", "extent": [9180, 9189], "body": [{"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": null, "value": "/crowds/sopcrowds", "type": "link", "text": ["SOP motion paths"], "fullpath": "/crowds/sopcrowds.html"}], "extent": [9189, 9228]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpath", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpath.html"}], "extent": [9228, 9257]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpathedit", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpathedit.html"}], "extent": [9257, 9290]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpathevaluate", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpathevaluate.html"}], "extent": [9290, 9327]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpathfollow", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpathfollow.html"}], "extent": [9327, 9362]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpathlayer", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpathlayer.html"}], "extent": [9362, 9396]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpathretime", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpathretime.html"}], "extent": [9396, 9431]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpathtransition", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpathtransition.html"}], "extent": [9431, 9470]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/crowdmotionpathtrigger", "type": "link", "text": "", "fullpath": "/nodes/sop/crowdmotionpathtrigger.html"}], "extent": [9470, 9506]}], "container": true}], "text": "Related"}], "title": ["Crowd MotionPath Avoid"], "summary": ["Deforms motion paths to avoid other agents and obstacles."]}